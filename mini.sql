-- IPL MANAGEMENT SYSTEM PROJECT
-- Complete relational database example

CREATE DATABASE IF NOT EXISTS IPL_DATABASE;

USE IPL_DATABASE;



-- TEAMS TABLE

CREATE TABLE TEAMS(
    TEAM_ID INT PRIMARY KEY,
    TEAM_NAME VARCHAR(50),
    CITY VARCHAR(50),
    OWNER VARCHAR(50)
);



-- PLAYERS TABLE

CREATE TABLE PLAYERS(
    PLAYER_ID INT PRIMARY KEY,
    PLAYER_NAME VARCHAR(50),
    ROLE VARCHAR(30),
    AGE INT,
    COUNTRY VARCHAR(50),
    TEAM_ID INT,
    FOREIGN KEY (TEAM_ID) REFERENCES TEAMS(TEAM_ID)
);



-- MATCHES TABLE

CREATE TABLE MATCHES(
    MATCH_ID INT PRIMARY KEY,
    TEAM1_ID INT,
    TEAM2_ID INT,
    MATCH_DATE DATE,
    VENUE VARCHAR(50),
    WINNER_TEAM_ID INT,
    FOREIGN KEY (TEAM1_ID) REFERENCES TEAMS(TEAM_ID),
    FOREIGN KEY (TEAM2_ID) REFERENCES TEAMS(TEAM_ID),
    FOREIGN KEY (WINNER_TEAM_ID) REFERENCES TEAMS(TEAM_ID)
);



-- PLAYER PERFORMANCE TABLE

CREATE TABLE PLAYER_PERFORMANCE(
    PERF_ID INT PRIMARY KEY,
    MATCH_ID INT,
    PLAYER_ID INT,
    RUNS INT,
    BALLS INT,
    WICKETS INT,
    CATCHES INT,
    FOREIGN KEY (MATCH_ID) REFERENCES MATCHES(MATCH_ID),
    FOREIGN KEY (PLAYER_ID) REFERENCES PLAYERS(PLAYER_ID)
);



-- INSERT TEAMS

INSERT INTO TEAMS VALUES (1,'MI','MUMBAI','RELIANCE');
INSERT INTO TEAMS VALUES (2,'CSK','CHENNAI','SRINIVASAN');
INSERT INTO TEAMS VALUES (3,'RCB','BANGALORE','UNITED SPIRITS');
INSERT INTO TEAMS VALUES (4,'KKR','KOLKATA','SHAHRUKH KHAN');
INSERT INTO TEAMS VALUES (5,'RR','JAIPUR','RAJASTHAN GROUP');



-- INSERT PLAYERS

INSERT INTO PLAYERS VALUES (1,'ROHIT SHARMA','BATSMAN',36,'INDIA',1);
INSERT INTO PLAYERS VALUES (2,'BUMRAH','BOWLER',30,'INDIA',1);
INSERT INTO PLAYERS VALUES (3,'DHONI','WK',42,'INDIA',2);
INSERT INTO PLAYERS VALUES (4,'JADEJA','ALL-ROUNDER',35,'INDIA',2);
INSERT INTO PLAYERS VALUES (5,'VIRAT KOHLI','BATSMAN',35,'INDIA',3);
INSERT INTO PLAYERS VALUES (6,'MAXWELL','ALL-ROUNDER',34,'AUSTRALIA',3);
INSERT INTO PLAYERS VALUES (7,'RUSSELL','ALL-ROUNDER',33,'WEST INDIES',4);
INSERT INTO PLAYERS VALUES (8,'NARINE','BOWLER',34,'WEST INDIES',4);
INSERT INTO PLAYERS VALUES (9,'BUTTLER','BATSMAN',32,'ENGLAND',5);
INSERT INTO PLAYERS VALUES (10,'ASHWIN','BOWLER',37,'INDIA',5);



-- INSERT MATCHES

INSERT INTO MATCHES VALUES (1,1,2,'2026-04-01','MUMBAI',1);
INSERT INTO MATCHES VALUES (2,3,4,'2026-04-02','BANGALORE',3);
INSERT INTO MATCHES VALUES (3,1,3,'2026-04-03','DELHI',3);
INSERT INTO MATCHES VALUES (4,2,4,'2026-04-04','CHENNAI',2);
INSERT INTO MATCHES VALUES (5,5,1,'2026-04-05','JAIPUR',5);



-- INSERT PERFORMANCE DATA

INSERT INTO PLAYER_PERFORMANCE VALUES (1,1,1,70,45,0,1);
INSERT INTO PLAYER_PERFORMANCE VALUES (2,1,2,5,10,3,0);
INSERT INTO PLAYER_PERFORMANCE VALUES (3,1,3,40,35,0,2);
INSERT INTO PLAYER_PERFORMANCE VALUES (4,2,5,85,60,0,0);
INSERT INTO PLAYER_PERFORMANCE VALUES (5,2,7,30,20,2,1);
INSERT INTO PLAYER_PERFORMANCE VALUES (6,3,5,60,40,0,0);
INSERT INTO PLAYER_PERFORMANCE VALUES (7,3,1,45,30,0,1);
INSERT INTO PLAYER_PERFORMANCE VALUES (8,4,4,55,35,1,2);
INSERT INTO PLAYER_PERFORMANCE VALUES (9,4,8,10,15,3,0);
INSERT INTO PLAYER_PERFORMANCE VALUES (10,5,9,100,65,0,0);
INSERT INTO PLAYER_PERFORMANCE VALUES (11,5,10,20,25,4,1);



-- BASIC SELECT

SELECT * FROM TEAMS;
SELECT * FROM PLAYERS;
SELECT * FROM MATCHES;
SELECT * FROM PLAYER_PERFORMANCE;



-- JOIN PLAYER WITH TEAM

SELECT P.PLAYER_NAME, T.TEAM_NAME
FROM PLAYERS P
JOIN TEAMS T
ON P.TEAM_ID = T.TEAM_ID;



-- MATCH DETAILS

SELECT M.MATCH_ID,
T1.TEAM_NAME AS TEAM1,
T2.TEAM_NAME AS TEAM2,
TW.TEAM_NAME AS WINNER
FROM MATCHES M
JOIN TEAMS T1 ON M.TEAM1_ID=T1.TEAM_ID
JOIN TEAMS T2 ON M.TEAM2_ID=T2.TEAM_ID
JOIN TEAMS TW ON M.WINNER_TEAM_ID=TW.TEAM_ID;



-- ORANGE CAP QUERY

SELECT P.PLAYER_NAME,SUM(PP.RUNS) AS TOTAL_RUNS
FROM PLAYER_PERFORMANCE PP
JOIN PLAYERS P ON PP.PLAYER_ID=P.PLAYER_ID
GROUP BY P.PLAYER_NAME
ORDER BY TOTAL_RUNS DESC
LIMIT 1;



-- PURPLE CAP QUERY

SELECT P.PLAYER_NAME,SUM(PP.WICKETS) AS TOTAL_WICKETS
FROM PLAYER_PERFORMANCE PP
JOIN PLAYERS P ON PP.PLAYER_ID=P.PLAYER_ID
GROUP BY P.PLAYER_NAME
ORDER BY TOTAL_WICKETS DESC
LIMIT 1;



-- TOP 3 BATSMEN

SELECT P.PLAYER_NAME,SUM(PP.RUNS) AS RUNS
FROM PLAYER_PERFORMANCE PP
JOIN PLAYERS P ON PP.PLAYER_ID=P.PLAYER_ID
GROUP BY P.PLAYER_NAME
ORDER BY RUNS DESC
LIMIT 3;



-- ALL ROUNDER PERFORMANCE

SELECT P.PLAYER_NAME,SUM(PP.RUNS),SUM(PP.WICKETS)
FROM PLAYER_PERFORMANCE PP
JOIN PLAYERS P ON PP.PLAYER_ID=P.PLAYER_ID
WHERE P.ROLE='ALL-ROUNDER'
GROUP BY P.PLAYER_NAME;



-- POINTS TABLE

SELECT T.TEAM_NAME,COUNT(M.MATCH_ID) AS WINS
FROM MATCHES M
JOIN TEAMS T ON M.WINNER_TEAM_ID=T.TEAM_ID
GROUP BY T.TEAM_NAME
ORDER BY WINS DESC;



-- SUBQUERY HIGHEST SCORE

SELECT *
FROM PLAYER_PERFORMANCE
WHERE RUNS=(SELECT MAX(RUNS) FROM PLAYER_PERFORMANCE);



-- LIKE OPERATOR

SELECT * FROM PLAYERS WHERE PLAYER_NAME LIKE 'R%';



-- REGEX SEARCH

SELECT * FROM PLAYERS WHERE PLAYER_NAME RLIKE '^V';



-- EXTRA ANALYTICS

SELECT AVG(RUNS) FROM PLAYER_PERFORMANCE;

SELECT MAX(WICKETS) FROM PLAYER_PERFORMANCE;

SELECT MIN(RUNS) FROM PLAYER_PERFORMANCE;

SELECT COUNT(*) FROM PLAYER_PERFORMANCE;

SELECT SUM(RUNS) FROM PLAYER_PERFORMANCE;
