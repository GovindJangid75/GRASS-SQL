-- DATE: 18 FEB 2026
-- LECTURE NO 8
-- TOPIC: JOINS IN SQL

-- JOINS are used to combine data from multiple tables
-- based on a related column between them.

-- Types of Joins:
-- 1. INNER JOIN
-- 2. LEFT JOIN
-- 3. RIGHT JOIN
-- 4. FULL JOIN (MySQL uses UNION for this)
-- 5. SELF JOIN
-- 6. CROSS JOIN


-- CREATE DATABASE

CREATE DATABASE IF NOT EXISTS SCHOOL_DB;

USE SCHOOL_DB;



-- CREATE TABLES

CREATE TABLE DEPARTMENT(
    ID INT PRIMARY KEY,
    DEPT_NAME VARCHAR(255),
    DEPT_HEAD VARCHAR(255)
);

CREATE TABLE STUDENT(
    ID INT PRIMARY KEY,
    NAME VARCHAR(255),
    EMAIL VARCHAR(255),
    CITY VARCHAR(255),
    MARKS INT,
    DEPT_ID INT,
    FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENT(ID)
);



-- INSERT DATA

INSERT INTO DEPARTMENT VALUES
(1,'COMPUTER SCIENCE','DR AKHIL'),
(2,'ELECTRONICS','UNKNOWN'),
(3,'MECHANICAL','Q BATU'),
(4,'CIVIL','MAHESH'),
(5,'CHEMICAL','GOPAL'),
(6,'ELECTRICAL','GOPAL');   -- extra department

INSERT INTO STUDENT VALUES
(1,'GOVIND','GOVIND@.COM','DELHI',90,1),
(2,'GORUAV','GORUAV@.COM','DELHI',97,2),
(3,'DILIP','DILIP@.COM','DELHI',89,3),
(4,'ARYAN','ARYAN@.COM','DELHI',88,4),
(5,'DEVANSH','DEVANSH@.COM','DELHI',99,5);


DROP table student;
SELECT * FROM STUDENT;
SELECT * FROM DEPARTMENT;



-- 1. INNER JOIN
-- Shows only matching records from both tables

SELECT *
FROM STUDENT
INNER JOIN DEPARTMENT
ON STUDENT.DEPT_ID = DEPARTMENT.ID;

-- Using alias (recommended professional style)

SELECT S.ID, S.NAME, S.MARKS, D.DEPT_NAME
FROM STUDENT S
INNER JOIN DEPARTMENT D
ON S.DEPT_ID = D.ID;



-- 2. LEFT JOIN
-- Shows all records from LEFT table (STUDENT)
-- If no match in right table, shows NULL

SELECT *
FROM STUDENT
LEFT JOIN DEPARTMENT
ON STUDENT.DEPT_ID = DEPARTMENT.ID;

-- Using alias

SELECT S.ID, S.NAME, S.MARKS, D.DEPT_NAME
FROM STUDENT S
LEFT JOIN DEPARTMENT D
ON S.DEPT_ID = D.ID;



-- 3. RIGHT JOIN
-- Shows all records from RIGHT table (DEPARTMENT)
-- If no match in left table, shows NULL

SELECT *
FROM STUDENT
RIGHT JOIN DEPARTMENT
ON STUDENT.DEPT_ID = DEPARTMENT.ID;

-- Using alias

SELECT S.ID, S.NAME, S.MARKS, D.DEPT_NAME
FROM STUDENT S
RIGHT JOIN DEPARTMENT D
ON S.DEPT_ID = D.ID;



-- 4. FULL JOIN (MySQL does not directly support FULL JOIN)
-- We simulate FULL JOIN using UNION of LEFT and RIGHT JOIN

SELECT *
FROM STUDENT
LEFT JOIN DEPARTMENT
ON STUDENT.DEPT_ID = DEPARTMENT.ID

UNION

SELECT *
FROM STUDENT
RIGHT JOIN DEPARTMENT
ON STUDENT.DEPT_ID = DEPARTMENT.ID;




select * from department;
-- 5. SELF JOIN
--  Different from other joins

SELECT A.NAME as Student
  B.id as department,
  A.ID
  FROM student A
  JOIN department B
  on A.`ID` =B.`ID`
  AND A.`ID` <> `B`.`ID`




